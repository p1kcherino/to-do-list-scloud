(()=>{"use strict";function t(t){t.classList.remove("popup_is-opened"),t.removeEventListener("click",e),document.removeEventListener("keydown",n)}function e(e){e.currentTarget===e.target&&t(e.currentTarget)}function n(e){"Escape"===e.key&&t(document.querySelector(".popup_is-opened"))}const o=document.querySelector(".form-add-task"),s=document.querySelector(".todo__add-task-input"),c=document.getElementById("clearButton"),u=document.querySelector(".todo__tasks-list"),d=(document.querySelector(".todo__tasks-items-title"),document.querySelectorAll(".popup__close-btn")),i=document.querySelector(".popup"),l=document.getElementById("removeBtn"),r=i.querySelector(".popup__input"),a=i.querySelector(".popup__btn-apply");o.addEventListener("submit",(function(o){o.preventDefault();const c=s.value,d={id:Date.now(),text:c,buttonText:"Открыт"};m.push(d);const f=`\n      <li class="todo__tasks-item" id="${d.id}" >\n          <h4 class="todo__tasks-items-title">\n              ${d.text}\n          </h4>\n          <button class="todo__tasks-items-button">${d.buttonText}</button>\n      </li>`;u.insertAdjacentHTML("beforeend",f),s.value="",s.focus(),u.addEventListener("click",(function(t){if("LI"===t.target.tagName||"BUTTON"===t.target.tagName||"H4"===t.target.tagName){p=t.target.closest("li").id;const o=t.target.closest("li").querySelector(".todo__tasks-items-title").textContent.trim();r.value=o,r.focus(),function(t){t.classList.add("popup_is-animated"),setTimeout((()=>{t.classList.add("popup_is-opened")}),1),t.addEventListener("click",e),document.addEventListener("keydown",n)}(i),_()}})),l.addEventListener("click",(function(){if(p){const e=document.getElementById(p);e&&(e.parentNode.removeChild(e),t(i))}})),a.addEventListener("click",(function(){const e=r.value,n=document.getElementById(p);n&&(n.querySelector(".todo__tasks-items-title").textContent=e,t(i))})),_()}));let m=[],p=null;function _(){const t=m.filter((t=>"Открыт"===m.status)).length,e=m.filter((t=>"В работе"===m.status)).length,n=m.filter((t=>"Закрыт"===m.status)).length;document.getElementById("openCount").textContent=t,document.getElementById("closeCount").textContent=n,document.getElementById("inProgressCount").textContent=e}c.addEventListener("click",(function(t){t.preventDefault(),s.value=""})),d.forEach((e=>{e.addEventListener("click",(function(){t(e.closest(".popup_is-opened"))}))})),document.querySelectorAll(".popup__status-button").forEach((e=>{e.addEventListener("click",(function(){const n=e.getAttribute("data-status"),o=document.getElementById(p);o&&(o.querySelector(".todo__tasks-items-button").textContent=n,t(i))}))}))})();