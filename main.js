(()=>{"use strict";function t(t){t.classList.remove("popup_is-opened"),t.removeEventListener("click",e),document.removeEventListener("keydown",n)}function e(e){e.currentTarget===e.target&&t(e.currentTarget)}function n(e){"Escape"===e.key&&t(document.querySelector(".popup_is-opened"))}const o=document.querySelector(".form-add-task"),s=document.querySelector(".todo__add-task-input"),c=document.getElementById("clearButton"),u=document.querySelector(".todo__tasks-list"),i=(document.querySelector(".todo__tasks-items-title"),document.querySelectorAll(".popup__close-btn")),d=document.querySelector(".popup"),r=document.getElementById("removeBtn"),l=d.querySelector(".popup__input"),a=d.querySelector(".popup__btn-apply");o.addEventListener("submit",(function(o){o.preventDefault();const c=s.value,i={id:Date.now(),text:c,status:"Открыт"};m.push(i);const f=`\n      <li class="todo__tasks-item" id="${i.id}" >\n          <h4 class="todo__tasks-items-title">\n              ${i.text}\n          </h4>\n          <button class="todo__tasks-items-button">${i.status}</button>\n      </li>`;u.insertAdjacentHTML("beforeend",f),s.value="",s.focus(),u.addEventListener("click",(function(t){if("LI"===t.target.tagName||"BUTTON"===t.target.tagName||"H4"===t.target.tagName){p=t.target.closest("li").id;const o=t.target.closest("li").querySelector(".todo__tasks-items-title").textContent.trim();l.value=o,l.focus(),function(t){t.classList.add("popup_is-animated"),setTimeout((()=>{t.classList.add("popup_is-opened")}),1),t.addEventListener("click",e),document.addEventListener("keydown",n)}(d),_()}})),r.addEventListener("click",(function(){if(p){const e=document.getElementById(p);e&&(e.parentNode.removeChild(e),m=m.filter((t=>t.id!==parseInt(p))),t(d),_())}})),a.addEventListener("click",(function(){const e=l.value,n=document.getElementById(p);n&&(n.querySelector(".todo__tasks-items-title").textContent=e,t(d))})),_()}));let m=[],p=null;function _(){const t=m.filter((t=>"Открыт"===t.status)).length,e=m.filter((t=>"В работе"===t.status)).length,n=m.filter((t=>"Закрыт"===t.status)).length;document.getElementById("openCount").textContent=t,document.getElementById("closeCount").textContent=n,document.getElementById("inProgressCount").textContent=e}c.addEventListener("click",(function(t){t.preventDefault(),s.value=""})),i.forEach((e=>{e.addEventListener("click",(function(){t(e.closest(".popup_is-opened"))}))})),document.querySelectorAll(".popup__status-button").forEach((e=>{e.addEventListener("click",(function(){const n=e.getAttribute("data-status");!function(t,e){const n=m.find((e=>e.id===parseInt(t)));if(n){n.status=e;const o=document.getElementById(t);o&&(o.querySelector(".todo__tasks-items-button").textContent=e),_()}}(p,n),t(d)}))}))})();