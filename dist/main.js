(()=>{"use strict";function t(t){t.classList.remove("popup_is-opened"),t.removeEventListener("click",e),document.removeEventListener("keydown",n)}function e(e){e.currentTarget===e.target&&t(e.currentTarget)}function n(e){"Escape"===e.key&&t(document.querySelector(".popup_is-opened"))}const o=document.querySelector(".form-add-task"),s=document.querySelector(".todo__add-task-input"),c=document.querySelector(".todo__tasks-list"),i=(document.querySelector(".todo__tasks-items-title"),document.querySelectorAll(".popup__close-btn")),u=document.querySelector(".popup"),d=document.getElementById("removeBtn"),r=u.querySelector(".popup__input"),a=u.querySelector(".popup__btn-apply");o.addEventListener("submit",(function(o){o.preventDefault();const i=s.value,m={id:Date.now(),text:i,buttonText:"Открыт"};l.push(m);const _=`\n      <li class="todo__tasks-item" id="${m.id}" >\n          <h4 class="todo__tasks-items-title">\n              ${m.text}\n          </h4>\n          <button class="todo__tasks-items-button">${m.buttonText}</button>\n      </li>`;c.insertAdjacentHTML("beforeend",_),s.value="",s.focus(),c.addEventListener("click",(function(t){if("LI"===t.target.tagName||"BUTTON"===t.target.tagName||"H4"===t.target.tagName){p=t.target.closest("li").id;const o=t.target.closest("li").querySelector(".todo__tasks-items-title").textContent.trim();r.value=o,r.focus(),function(t){t.classList.add("popup_is-animated"),setTimeout((()=>{t.classList.add("popup_is-opened")}),1),t.addEventListener("click",e),document.addEventListener("keydown",n)}(u)}})),d.addEventListener("click",(function(){if(p){const e=document.getElementById(p);e&&(e.parentNode.removeChild(e),t(u))}})),a.addEventListener("click",(function(){const e=r.value,n=document.getElementById(p);n&&(n.querySelector(".todo__tasks-items-title").textContent=e,t(u))}))}));let l=[],p=null;i.forEach((e=>{e.addEventListener("click",(function(){t(e.closest(".popup_is-opened"))}))}))})();